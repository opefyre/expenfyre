exports.id=497,exports.ids=[497],exports.modules={1018:(a,b,c)=>{"use strict";c.d(b,{G6:()=>e,HW:()=>f,Ud:()=>g});let d="https://expense-tracker-api.opefyre.workers.dev";function e(){let a=window.open(`${d}/api/auth/google`,"google-auth","width=500,height=600,scrollbars=yes,resizable=yes");if(!a)throw Error("Popup blocked by browser");return a}async function f(){let a=h("access_token"),b={"Content-Type":"application/json"};a&&(b.Authorization=`Bearer ${a}`);try{let a=await fetch(`${d}/api/auth/me`,{method:"GET",headers:b,credentials:"include"});if(!a.ok){if(401===a.status)return console.log("getCurrentUser: 401 Unauthorized - no valid token"),null;let b=await a.text();return console.error("Auth check failed:",a.status,b),null}let c=await a.json();if(c.success&&c.user)return c.user;return console.error("Invalid user data received:",c),null}catch(a){return console.error("getCurrentUser error:",a),null}}async function g(a,b={}){let c=h("access_token"),e=h("refresh_token"),f={...b.headers};f["Content-Type"]||b.body instanceof FormData||(f["Content-Type"]="application/json"),c&&(f.Authorization=`Bearer ${c}`);let i=await fetch(`${d}${a}`,{...b,headers:f,credentials:"include"});if(401===i.status&&e&&"/api/auth/refresh"!==a){console.log("Access token expired, attempting refresh...");try{let c=await fetch(`${d}/api/auth/refresh`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},credentials:"include"});if(c.ok){let e=await c.json();console.log("Token refresh successful"),document.cookie=`access_token=${e.access_token}; Secure; SameSite=None; Path=/; Max-Age=900`,document.cookie=`refresh_token=${e.refresh_token}; Secure; SameSite=None; Path=/; Max-Age=604800`,f.Authorization=`Bearer ${e.access_token}`,i=await fetch(`${d}${a}`,{...b,headers:f,credentials:"include"}),console.log("Retry request successful:",i.status)}else console.error("Token refresh failed:",c.status),document.cookie="access_token=; Secure; SameSite=None; Path=/; Max-Age=0",document.cookie="refresh_token=; Secure; SameSite=None; Path=/; Max-Age=0",window.location.href="/"}catch(a){console.error("Token refresh failed:",a),document.cookie="access_token=; Secure; SameSite=None; Path=/; Max-Age=0",document.cookie="refresh_token=; Secure; SameSite=None; Path=/; Max-Age=0",window.location.href="/"}}return i}function h(a){let b=`; ${document.cookie}`.split(`; ${a}=`);return 2===b.length&&b.pop()?.split(";").shift()||null}},1183:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,5023,23)),Promise.resolve().then(c.t.bind(c,9390,23)),Promise.resolve().then(c.t.bind(c,7880,23)),Promise.resolve().then(c.t.bind(c,2895,23)),Promise.resolve().then(c.t.bind(c,6743,23)),Promise.resolve().then(c.t.bind(c,5676,23)),Promise.resolve().then(c.t.bind(c,4057,23)),Promise.resolve().then(c.t.bind(c,630,23)),Promise.resolve().then(c.t.bind(c,3439,23))},3244:(a,b,c)=>{"use strict";c.d(b,{G:()=>h,s:()=>g});var d=c(7777),e=c(7172);let f=(0,e.createContext)(void 0);function g({children:a}){let[b,c]=(0,e.useState)(!1),[g,h]=(0,e.useState)(null),i=(0,e.useCallback)(a=>{h(a),c(!0)},[]),j=(0,e.useCallback)(()=>{c(!1),h(null)},[]);return(0,d.jsx)(f.Provider,{value:{showConfirm:i,hideConfirm:j,isOpen:b,dialogData:g},children:a})}function h(){let a=(0,e.useContext)(f);if(void 0===a)throw Error("useConfirmDialog must be used within a ConfirmDialogProvider");return a}},4611:(a,b,c)=>{"use strict";c.d(b,{Ax:()=>i,dj:()=>h,tE:()=>g});var d=c(7777),e=c(7172);let f=(0,e.createContext)(void 0);function g({children:a}){let[b,c]=(0,e.useState)([]),g=(0,e.useCallback)(a=>{let b=Math.random().toString(36).substr(2,9),d=3e3;"error"===a.type?d=5e3:"success"===a.type?d=2500:"warning"===a.type&&(d=4e3);let e={id:b,duration:void 0!==a.duration?a.duration:d,...a};console.log("Adding toast:",{type:a.type,duration:e.duration,title:a.title}),c(a=>[...a,e])},[]),h=(0,e.useCallback)(a=>{c(b=>b.filter(b=>b.id!==a))},[]),i=(0,e.useCallback)(()=>{c([])},[]);return(0,d.jsx)(f.Provider,{value:{toasts:b,addToast:g,removeToast:h,clearToasts:i},children:a})}function h(){let a=(0,e.useContext)(f);if(void 0===a)throw Error("useToast must be used within a ToastProvider");return a}function i(){let{addToast:a}=h(),b=(0,e.useCallback)((b,c,d)=>{a({type:"success",title:b,message:c,duration:d})},[a]),c=(0,e.useCallback)((b,c,d)=>{a({type:"error",title:b,message:c,duration:d})},[a]);return{showSuccess:b,showError:c,showWarning:(0,e.useCallback)((b,c,d)=>{a({type:"warning",title:b,message:c,duration:d})},[a]),showInfo:(0,e.useCallback)((b,c,d)=>{a({type:"info",title:b,message:c,duration:d})},[a])}}},4733:(a,b,c)=>{Promise.resolve().then(c.bind(c,8260))},4769:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>p});var d=c(7777);c(6473);var e=c(4611),f=c(8792),g=c(3244),h=c(8649);function i(){let{isLoading:a,loadingMessage:b}=(0,f.M)();return a?(0,d.jsx)("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-md z-50 flex items-center justify-center",children:(0,d.jsx)("div",{className:"bg-white/90 backdrop-blur-xl rounded-3xl p-6 shadow-2xl border border-white/20 max-w-xs mx-4",children:(0,d.jsxs)("div",{className:"flex flex-col items-center space-y-3",children:[(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)("div",{className:"w-8 h-8 border-2 border-slate-200 rounded-full"}),(0,d.jsx)("div",{className:"absolute top-0 left-0 w-8 h-8 border-2 border-slate-600 border-t-transparent rounded-full animate-spin"})]}),(0,d.jsx)("div",{className:"text-center",children:(0,d.jsx)("p",{className:"text-sm font-medium text-slate-700",children:b})})]})})}):null}var j=c(7172);let k=function({toast:a,onRemove:b}){let[c,e]=(0,j.useState)(!1),[f,g]=(0,j.useState)(!1);return(0,j.useRef)(b),(0,d.jsx)("div",{className:`transform transition-all duration-300 ease-out ${c&&!f?"translate-x-0 opacity-100 scale-100":"translate-x-full opacity-0 scale-95"}`,children:(0,d.jsx)("div",{className:`${(()=>{let b="rounded-xl border shadow-lg backdrop-blur-sm transition-all duration-300 ease-out";switch(a.type){case"success":return`${b} bg-emerald-50 border-emerald-200 text-emerald-900`;case"error":return`${b} bg-red-50 border-red-200 text-red-900`;case"warning":return`${b} bg-amber-50 border-amber-200 text-amber-900`;case"info":return`${b} bg-blue-50 border-blue-200 text-blue-900`;default:return`${b} bg-slate-50 border-slate-200 text-slate-900`}})()} p-4 min-w-80 max-w-md`,children:(0,d.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,d.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:(()=>{switch(a.type){case"success":return(0,d.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});case"error":case"warning":return(0,d.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})});case"info":return(0,d.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}})()}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("h4",{className:"font-semibold text-sm",children:a.title}),a.message&&(0,d.jsx)("p",{className:"text-sm opacity-90 mt-1",children:a.message})]}),(0,d.jsx)("button",{onClick:()=>{g(!0),setTimeout(()=>{b(a.id)},300)},className:"flex-shrink-0 p-1 rounded-lg hover:bg-black/5 transition-colors",children:(0,d.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})})};function l(){let{toasts:a,removeToast:b}=(0,e.dj)();return 0===a.length?null:(0,d.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:a.map(a=>(0,d.jsx)(k,{toast:a,onRemove:b},a.id))})}function m({isOpen:a,title:b,message:c,confirmText:e="Confirm",cancelText:f="Cancel",type:g="danger",onConfirm:h,onCancel:i}){let[k,l]=(0,j.useState)(!1);if(!a)return null;let m=(()=>{switch(g){case"danger":return{icon:(0,d.jsx)("svg",{className:"w-6 h-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),confirmButton:"bg-red-600 hover:bg-red-700 text-white"};case"warning":return{icon:(0,d.jsx)("svg",{className:"w-6 h-6 text-amber-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),confirmButton:"bg-amber-600 hover:bg-amber-700 text-white"};case"info":return{icon:(0,d.jsx)("svg",{className:"w-6 h-6 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),confirmButton:"bg-blue-600 hover:bg-blue-700 text-white"}}})();return(0,d.jsx)("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,d.jsx)("div",{className:`bg-white rounded-2xl shadow-2xl border border-slate-200 max-w-md w-full transform transition-all duration-200 ${k?"scale-100 opacity-100":"scale-95 opacity-0"}`,children:(0,d.jsxs)("div",{className:"p-6",children:[(0,d.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,d.jsx)("div",{className:"flex-shrink-0",children:m.icon}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:b}),(0,d.jsx)("p",{className:"text-sm text-slate-600",children:c})]})]}),(0,d.jsxs)("div",{className:"flex items-center justify-end space-x-3 mt-6",children:[(0,d.jsx)("button",{onClick:()=>{l(!1),setTimeout(()=>i(),150)},className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 transition-colors",children:f}),(0,d.jsx)("button",{onClick:()=>{l(!1),setTimeout(()=>h(),150)},className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors ${m.confirmButton}`,children:e})]})]})})})}function n(){let{isOpen:a,dialogData:b,hideConfirm:c}=(0,g.G)();return b?(0,d.jsx)(m,{isOpen:a,title:b.title,message:b.message,confirmText:b.confirmText,cancelText:b.cancelText,type:b.type,onConfirm:()=>{b.onConfirm(),c()},onCancel:c}):null}function o({children:a}){let[b,c]=(0,j.useState)(null),[e,f]=(0,j.useState)(!0);return(0,d.jsx)(h.M,{user:b,children:a})}function p({children:a}){return(0,d.jsxs)("html",{lang:"en",children:[(0,d.jsxs)("head",{children:[(0,d.jsx)("link",{rel:"icon",href:"/icon-192x192.png?v=3",type:"image/png"}),(0,d.jsx)("link",{rel:"shortcut icon",href:"/icon-192x192.png?v=3",type:"image/png"}),(0,d.jsx)("link",{rel:"manifest",href:"/manifest.json?v=3"}),(0,d.jsx)("meta",{name:"theme-color",content:"#3b82f6"}),(0,d.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover"}),(0,d.jsx)("meta",{name:"apple-mobile-web-app-capable",content:"yes"}),(0,d.jsx)("meta",{name:"mobile-web-app-capable",content:"yes"}),(0,d.jsx)("meta",{name:"apple-mobile-web-app-status-bar-style",content:"default"}),(0,d.jsx)("meta",{name:"apple-mobile-web-app-title",content:"Expenfyre"}),(0,d.jsx)("link",{rel:"apple-touch-icon",href:"/icon-192x192.png?v=3"}),(0,d.jsx)("link",{rel:"apple-touch-icon",sizes:"192x192",href:"/icon-192x192.png?v=3"}),(0,d.jsx)("link",{rel:"apple-touch-icon",sizes:"512x512",href:"/icon-512x512.png?v=3"}),(0,d.jsx)("meta",{name:"msapplication-TileImage",content:"/icon-192x192.png?v=3"}),(0,d.jsx)("meta",{name:"msapplication-TileColor",content:"#3b82f6"}),(0,d.jsx)("title",{children:"Expenfyre - Expense Tracker"}),(0,d.jsx)("meta",{name:"description",content:"Modern expense tracking and financial management application"})]}),(0,d.jsx)("body",{children:(0,d.jsx)(e.tE,{children:(0,d.jsx)(f.o,{children:(0,d.jsx)(g.s,{children:(0,d.jsxs)(o,{children:[a,(0,d.jsx)(i,{}),(0,d.jsx)(l,{}),(0,d.jsx)(n,{})]})})})})})]})}c(1018)},5607:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,7513,23)),Promise.resolve().then(c.t.bind(c,2896,23)),Promise.resolve().then(c.t.bind(c,5438,23)),Promise.resolve().then(c.t.bind(c,3217,23)),Promise.resolve().then(c.t.bind(c,3413,23)),Promise.resolve().then(c.t.bind(c,61,23)),Promise.resolve().then(c.t.bind(c,607,23)),Promise.resolve().then(c.t.bind(c,4144,23)),Promise.resolve().then(c.bind(c,317))},6473:()=>{},8260:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(547).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/abolfazlshirkavand/Desktop/Projects/expense-tracker/web/src/app/layout.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/abolfazlshirkavand/Desktop/Projects/expense-tracker/web/src/app/layout.tsx","default")},8649:(a,b,c)=>{"use strict";c.d(b,{M:()=>n,E:()=>o});var d=c(7777),e=c(7172),f=c(1018);let g=new Map,h=new Map,i={enabled:!0,staleTime:3e5,cacheTime:6e5,retry:!0,retryDelay:1e3,maxRetries:3},j=a=>new Promise(b=>setTimeout(b,a));function k(a,b,c={}){let d={...i,...c},[f,l]=(0,e.useState)({data:null,loading:!1,error:null,lastFetched:null}),m=(0,e.useRef)(!0),n=(0,e.useRef)(0),o=(0,e.useCallback)(async(b=!1)=>{let c,e;if(!d.enabled)return null;let f=g.get(a);if(!b&&f&&(c=f.timestamp,e=d.staleTime,!(Date.now()-c>e)))return m.current&&l(a=>({...a,data:f.data,error:null,lastFetched:f.timestamp})),f.data;let i=h.get(a);if(i)try{return await i}catch(a){throw a}++n.current;let j=p();h.set(a,j);try{let b=await j;return g.set(a,{data:b,timestamp:Date.now()}),m.current&&l({data:b,loading:!1,error:null,lastFetched:Date.now()}),b}catch(a){throw m.current&&l(b=>({...b,loading:!1,error:a instanceof Error?a.message:"Unknown error"})),a}finally{h.delete(a)}},[a,b,d.enabled,d.staleTime]),p=async()=>{let a;for(let c=0;c<=d.maxRetries;c++)try{return m.current&&l(a=>({...a,loading:!0,error:null})),await b()}catch(b){if(a=b instanceof Error?b:Error("Unknown error"),c===d.maxRetries)throw a;await j(d.retryDelay*Math.pow(2,c))}throw a};return{...f,refetch:()=>o(!0),invalidate:()=>{g.delete(a),h.delete(a)}}}let l={clear:()=>{g.clear(),h.clear()},clearByPattern:a=>{for(let b of g.keys())b.includes(a)&&(g.delete(b),h.delete(b))}},m=(0,e.createContext)(void 0);function n({children:a,user:b}){let c=function(a,b={}){return k(`expenses-${JSON.stringify(a||{})}`,async()=>{let b=new URLSearchParams;a&&Object.entries(a).forEach(([a,c])=>{null!=c&&""!==c&&b.append(a,String(c))}),b.append("limit","100");let c=await (0,f.Ud)(`/api/expenses?${b.toString()}`);if(!c.ok)throw Error(`Failed to fetch expenses: ${c.status}`);let d=await c.json();if(!d.success)throw Error(d.error||"Failed to fetch expenses");return d.data||[]},{staleTime:12e4,cacheTime:3e5,...b})}({},{enabled:!!b}),g=function(a,b={}){return k(`budgets-${JSON.stringify(a||{})}`,async()=>{let b=new URLSearchParams;a&&Object.entries(a).forEach(([a,c])=>{null!=c&&""!==c&&b.append(a,String(c))});let c=await (0,f.Ud)(`/api/budgets?${b.toString()}`);if(!c.ok)throw Error(`Failed to fetch budgets: ${c.status}`);let d=await c.json();if(!d.success)throw Error(d.error||"Failed to fetch budgets");return d.data||[]},{staleTime:3e5,cacheTime:6e5,...b})}({},{enabled:!!b}),h=function(a={}){return k("categories",async()=>{let a=await (0,f.Ud)("/api/categories");if(!a.ok)throw Error(`Failed to fetch categories: ${a.status}`);let b=await a.json();if(!b.success)throw Error(b.error||"Failed to fetch categories");return b.data||[]},{staleTime:6e5,cacheTime:18e5,...a})}({enabled:!!b}),i=(0,e.useMemo)(()=>a=>c.data?.filter(b=>b.month===a)||[],[c.data]),j=(0,e.useMemo)(()=>a=>g.data?.filter(b=>b.month===a)||[],[g.data]),n=(0,e.useMemo)(()=>a=>h.data?.find(b=>b.category_id===a),[h.data]),o=(0,e.useMemo)(()=>a=>g.data?.find(b=>b.budget_id===a),[g.data]),p=a=>{"all"!==a&&a?l.clearByPattern(a):l.clear()},q=async a=>{p("expenses"),await c.refetch()},r=async(a,b)=>{p("expenses"),await c.refetch()},s=async a=>{p("expenses"),await c.refetch()},t=async a=>{p("budgets"),await g.refetch()},u=async(a,b)=>{p("budgets"),await g.refetch()},v=async a=>{p("budgets"),await g.refetch()},w={expenses:c.data||[],budgets:g.data||[],categories:h.data||[],loading:{expenses:c.loading,budgets:g.loading,categories:h.loading},error:{expenses:c.error,budgets:g.error,categories:h.error},refetchExpenses:c.refetch,refetchBudgets:g.refetch,refetchCategories:h.refetch,invalidateCache:p,getExpensesByMonth:i,getBudgetsByMonth:j,getCategoryById:n,getBudgetById:o,addExpense:q,updateExpense:r,deleteExpense:s,addBudget:t,updateBudget:u,deleteBudget:v};return(0,d.jsx)(m.Provider,{value:w,children:a})}function o(){let a=(0,e.useContext)(m);if(void 0===a)throw Error("useData must be used within a DataProvider");return a}},8701:(a,b,c)=>{Promise.resolve().then(c.bind(c,4769))},8792:(a,b,c)=>{"use strict";c.d(b,{M:()=>h,o:()=>g});var d=c(7777),e=c(7172);let f=(0,e.createContext)(void 0);function g({children:a}){let[b,c]=(0,e.useState)(!1),[g,h]=(0,e.useState)("Loading..."),i=(0,e.useCallback)((a,b="Loading...")=>{c(a),h(b)},[]),j=(0,e.useCallback)((a="Loading...")=>{i(!0,a)},[i]),k=(0,e.useCallback)(()=>{i(!1)},[i]);return(0,d.jsx)(f.Provider,{value:{isLoading:b,loadingMessage:g,setLoading:i,showLoading:j,hideLoading:k},children:a})}function h(){let a=(0,e.useContext)(f);if(void 0===a)throw Error("useLoading must be used within a LoadingProvider");return a}}};