(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{186:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>x});var l=t(4248),a=t(4564),r=t(4650);function n(e){let{userInfo:s,onClose:t}=e,[r,n]=(0,a.useState)(!1),[o,i]=(0,a.useState)(!1),[c,d]=(0,a.useState)(null),x=async()=>{n(!0),d(null);try{let e="https://expense-tracker-api.opefyre.workers.dev";console.log("Submitting access request to:","".concat(e,"/api/access-request")),console.log("User info:",s);let t=await fetch("".concat(e,"/api/access-request"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});console.log("Response status:",t.status),console.log("Response ok:",t.ok);let l=await t.json();console.log("Response result:",l),l.success?i(!0):d(l.error||"Failed to submit access request")}catch(e){console.error("Access request error:",e),d("Network error. Please try again.")}finally{n(!1)}};return o?(0,l.jsxs)("div",{className:"min-h-screen flex items-center justify-center relative overflow-hidden",children:[(0,l.jsxs)("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-50 via-teal-50 to-cyan-50",children:[(0,l.jsx)("div",{className:"absolute top-1/4 left-1/4 w-72 h-72 bg-emerald-200/30 rounded-full blur-3xl float"}),(0,l.jsx)("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-teal-200/30 rounded-full blur-3xl float",style:{animationDelay:"2s"}}),(0,l.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-cyan-200/20 rounded-full blur-2xl float",style:{animationDelay:"4s"}})]}),(0,l.jsx)("div",{className:"relative z-10 w-full max-w-md mx-4",children:(0,l.jsxs)("div",{className:"glass-card rounded-3xl p-8 text-center",children:[(0,l.jsx)("div",{className:"checkmark mb-6",children:(0,l.jsx)("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-3xl font-bold text-slate-800 mb-3",children:"Request Submitted!"}),(0,l.jsx)("p",{className:"text-slate-600 text-lg",children:"Your access request has been successfully submitted."})]}),(0,l.jsxs)("button",{onClick:t,className:"btn-primary w-full flex items-center justify-center space-x-2 py-4 text-lg font-medium",children:[(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),(0,l.jsx)("span",{children:"Close"})]})]})]})})]}):(0,l.jsxs)("div",{className:"min-h-screen flex items-center justify-center relative overflow-hidden",children:[(0,l.jsxs)("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:[(0,l.jsx)("div",{className:"absolute top-1/4 left-1/4 w-72 h-72 bg-blue-200/30 rounded-full blur-3xl float"}),(0,l.jsx)("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-purple-200/30 rounded-full blur-3xl float",style:{animationDelay:"2s"}}),(0,l.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-indigo-200/20 rounded-full blur-2xl float",style:{animationDelay:"4s"}})]}),(0,l.jsx)("div",{className:"relative z-10 w-full max-w-md mx-4",children:(0,l.jsxs)("div",{className:"glass-card rounded-3xl p-8",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsx)("div",{className:"info-icon mb-6",children:(0,l.jsx)("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),(0,l.jsx)("h2",{className:"text-3xl font-bold text-slate-800 mb-3",children:"Request Access"}),(0,l.jsx)("p",{className:"text-slate-600",children:"Submit your information to request access"})]}),(0,l.jsxs)("div",{className:"p-6 bg-slate-50/50 rounded-2xl border border-slate-200/50 mb-8",children:[(0,l.jsx)("p",{className:"text-sm font-semibold text-slate-700 mb-4 text-center",children:"Your Information"}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[s.picture&&(0,l.jsx)("img",{src:s.picture,alt:"Profile",className:"w-16 h-16 rounded-2xl border-4 border-white/50 shadow-lg"}),(0,l.jsxs)("div",{className:"flex-1 text-left",children:[(0,l.jsx)("p",{className:"text-lg font-semibold text-slate-800 mb-1",children:s.name}),(0,l.jsx)("p",{className:"text-slate-500 text-sm",children:s.email}),(0,l.jsxs)("div",{className:"mt-2 flex items-center space-x-2",children:[(0,l.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,l.jsx)("span",{className:"text-xs text-slate-500",children:"Google Account"})]})]})]})]}),c&&(0,l.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl",children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("svg",{className:"w-5 h-5 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,l.jsx)("p",{className:"text-red-700 text-sm font-medium",children:c})]})}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("button",{onClick:x,disabled:r,className:"btn-success w-full flex items-center justify-center space-x-2 py-4 text-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:r?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"spinner w-5 h-5"}),(0,l.jsx)("span",{children:"Submitting..."})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),(0,l.jsx)("span",{children:"Submit Access Request"})]})}),(0,l.jsxs)("button",{onClick:t,disabled:r,className:"btn-secondary w-full flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),(0,l.jsx)("span",{children:"Cancel"})]})]})]})})]})}function o(e){let{onRetry:s,userInfo:t}=e,[r,o]=(0,a.useState)(!1);return r&&t?(0,l.jsx)(n,{userInfo:t,onClose:()=>o(!1)}):(0,l.jsxs)("div",{className:"min-h-screen flex items-center justify-center relative overflow-hidden",children:[(0,l.jsxs)("div",{className:"absolute inset-0 bg-gradient-to-br from-red-50 via-orange-50 to-yellow-50",children:[(0,l.jsx)("div",{className:"absolute top-1/4 left-1/4 w-72 h-72 bg-red-200/30 rounded-full blur-3xl float"}),(0,l.jsx)("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-orange-200/30 rounded-full blur-3xl float",style:{animationDelay:"2s"}}),(0,l.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-yellow-200/20 rounded-full blur-2xl float",style:{animationDelay:"4s"}})]}),(0,l.jsx)("div",{className:"relative z-10 w-full max-w-md mx-4",children:(0,l.jsxs)("div",{className:"glass-card rounded-3xl p-8 text-center",children:[(0,l.jsx)("div",{className:"error-icon mb-6",children:(0,l.jsx)("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-slate-800 mb-3",children:"Access Denied"}),(0,l.jsx)("p",{className:"text-slate-600 text-lg",children:"You are not authorized to access this application."}),(0,l.jsx)("p",{className:"text-slate-500 text-sm mt-2",children:"Request access below or contact your administrator."})]}),t&&(0,l.jsxs)("div",{className:"p-4 bg-slate-50/50 rounded-2xl border border-slate-200/50",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-slate-700 mb-2",children:"Your Information:"}),(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[t.picture&&(0,l.jsx)("img",{src:t.picture,alt:"Profile",className:"w-10 h-10 rounded-xl border-2 border-white/50"}),(0,l.jsxs)("div",{className:"text-left",children:[(0,l.jsx)("p",{className:"text-sm font-semibold text-slate-800",children:t.name}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:t.email})]})]})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[t&&(0,l.jsxs)("button",{onClick:()=>o(!0),className:"btn-success w-full flex items-center justify-center space-x-2 py-4 text-lg font-medium",children:[(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),(0,l.jsx)("span",{children:"Request Access"})]}),s&&(0,l.jsxs)("button",{onClick:s,className:"btn-primary w-full flex items-center justify-center space-x-2",children:[(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,l.jsx)("span",{children:"Try Again"})]}),(0,l.jsxs)("button",{onClick:()=>window.location.reload(),className:"btn-secondary w-full flex items-center justify-center space-x-2",children:[(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,l.jsx)("span",{children:"Refresh Page"})]})]})]})]})})]})}var i=t(1302),c=t(2536),d=t(1795);function x(){let[e,s]=(0,a.useState)(null),[t,n]=(0,a.useState)(null),[x,m]=(0,a.useState)(!1),[h,u]=(0,a.useState)(null),{showLoading:f,hideLoading:j}=(0,c.M)(),{showSuccess:p,showError:b}=(0,d.Ax)();(0,a.useEffect)(()=>{v()},[]),(0,a.useEffect)(()=>{let e=e=>{var t,l;if((null==(t=e.data)?void 0:t.type)==="AUTH_SUCCESS"){if(e.data.tokens){let{access_token:s,refresh_token:t}=e.data.tokens;document.cookie="access_token=".concat(s,"; Secure; SameSite=None; Path=/; Max-Age=900"),document.cookie="refresh_token=".concat(t,"; Secure; SameSite=None; Path=/; Max-Age=604800")}e.data.user&&s(e.data.user),v()}else(null==(l=e.data)?void 0:l.type)==="ACCESS_DENIED"&&(s(null),m(!0),e.data.userInfo&&u(e.data.userInfo))};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)},[]),(0,a.useEffect)(()=>{if(!t)return;let e=setInterval(()=>{t.closed&&(n(null),clearInterval(e),v())},1e3);return()=>clearInterval(e)},[t]);let v=async()=>{f("Checking authentication...");try{let e=await (0,r.HW)();e?s(e):s(null)}catch(e){s(null)}finally{j()}},g=async()=>{try{f("Redirecting to Google for login...");let e=await (0,r.G6)(),s=window.open(e,"oauthPopup","width=600,height=700,left=200,top=200");n(s)}catch(e){console.error("Google sign-in failed:",e),b("Google sign-in failed","Please try again."),j()}},N=async()=>{try{f("Signing out..."),await (0,r.Ud)("/api/auth/signout",{method:"POST"}),document.cookie="access_token=; Secure; SameSite=None; Path=/; Max-Age=0",document.cookie="refresh_token=; Secure; SameSite=None; Path=/; Max-Age=0",s(null),p("Signed out successfully!"),window.location.href="/"}catch(e){console.error("Sign out error:",e),b("Sign out failed","Please try again.")}finally{j()}};return x?(0,l.jsx)(o,{userInfo:h||void 0,onRetry:()=>m(!1)}):e?(0,l.jsx)(i.A,{user:e,currentPage:"/",onSignOut:N,children:(0,l.jsx)(function(){return(0,l.jsx)("div",{className:"h-full flex flex-col",children:(0,l.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-900",children:"Dashboard"}),(0,l.jsx)("p",{className:"text-slate-600 mt-1",children:"Welcome back! Here's your financial overview"})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"Current Month"}),(0,l.jsx)("p",{className:"text-xl sm:text-2xl font-bold",children:new Date().toLocaleDateString("en-US",{month:"long",year:"numeric"})})]})]})}),(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Quick Actions"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[(0,l.jsxs)("a",{href:"/expenses",className:"bg-white rounded-lg p-4 border border-slate-200 hover:shadow-md transition-shadow text-center group",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-2 group-hover:bg-blue-200 transition-colors",children:(0,l.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),(0,l.jsx)("p",{className:"text-sm font-medium text-slate-900",children:"Add Expense"})]}),(0,l.jsxs)("a",{href:"/budgets",className:"bg-white rounded-lg p-4 border border-slate-200 hover:shadow-md transition-shadow text-center group",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mx-auto mb-2 group-hover:bg-green-200 transition-colors",children:(0,l.jsx)("svg",{className:"w-5 h-5 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),(0,l.jsx)("p",{className:"text-sm font-medium text-slate-900",children:"Add Budget"})]}),(0,l.jsxs)("a",{href:"/analytics",className:"bg-white rounded-lg p-4 border border-slate-200 hover:shadow-md transition-shadow text-center group",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center mx-auto mb-2 group-hover:bg-purple-200 transition-colors",children:(0,l.jsx)("svg",{className:"w-5 h-5 text-purple-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),(0,l.jsx)("p",{className:"text-sm font-medium text-slate-900",children:"View Analytics"})]}),(0,l.jsxs)("a",{href:"/expenses",className:"bg-white rounded-lg p-4 border border-slate-200 hover:shadow-md transition-shadow text-center group",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mx-auto mb-2 group-hover:bg-orange-200 transition-colors",children:(0,l.jsx)("svg",{className:"w-5 h-5 text-orange-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})})}),(0,l.jsx)("p",{className:"text-sm font-medium text-slate-900",children:"View Expenses"})]})]})]})]})})},{})}):(0,l.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center p-4",children:(0,l.jsxs)("div",{className:"w-full max-w-sm mx-auto",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-black mb-2",children:"Expenfyre"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Sign in to continue"})]}),(0,l.jsxs)("button",{onClick:g,className:"w-full bg-black text-white px-6 py-3 rounded-lg font-medium hover:bg-gray-800 transition-colors flex items-center justify-center space-x-3",children:[(0,l.jsxs)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:[(0,l.jsx)("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),(0,l.jsx)("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),(0,l.jsx)("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),(0,l.jsx)("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),(0,l.jsx)("span",{children:"Continue with Google"})]})]})})}},1854:(e,s,t)=>{Promise.resolve().then(t.bind(t,186))}},e=>{e.O(0,[916,647,516,358],()=>e(e.s=1854)),_N_E=e.O()}]);